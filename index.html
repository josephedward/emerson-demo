<link rel="stylesheet" href="./og.css" />
<link rel="stylesheet" href="//www.openglobus.org/og.css" type="text/css" />
<script src="//www.openglobus.org/og.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/json2html/2.2.1/json2html.min.js"></script>
<div id="globus"></div>

<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/dotenv@16.0.0/lib/main.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.10.2/p5.js"></script>
<script type="module">
  import { layer, Globe, terrain } from "./og.esm.js";

  const { XYZ } = layer;
  const { GlobusTerrain } = terrain;

  const osm = new XYZ("OpenStreetMap", {
    isBaseLayer: true,
    url: "//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",
    visibility: true,
  });

  const globus = new Globe({
    target: "globus", // a HTMLDivElement which its id is `globus`
    name: "Earth",
    terrain: new GlobusTerrain(),
    layers: [osm],
    autoActivated: true,
  });

  const key = "d3104375bd592736cf8775886538ee2a";

  // let myPopup = new og.Popup({
  //   planet: globus.planet,
  //   offset: [0, -25],
  //   visibility: false,
  // });


  for(let x = -90;x<=90;x+=30){
    for(let y = -180;y<=180;y+=30){
    // console.log(x,y)
    let lonLat = new og.LonLat(y,x);
    let myPopup = new og.Popup({
    planet: globus.planet,
    offset: [0, -25],
    // visibility: false,
  });
      // let lonLat = globus.planet.getLonLatFromPixelTerrain(x,y);
      console.log(lonLat)
      // globus.planet.terrain.getHeightAsync(lonLat, (h) => {
      //  let groundPos = globus.planet.getCartesianFromMouseTerrain();
      //   myPopup.setCartesian3v(groundPos);
        myPopup.setContent(`<div>${x},${y}</div>`);
        myPopup.setVisibility(true);
      // });
    }
  }

  // globus.planet.renderer.events.on("lclick", (e) => {
  //   const coords = document
  //     .querySelector(".ogEarthCoordinatesControl")
  //     .innerText.split(",");

  //   const lat = coords[0].split(" ")[1];
  //   const lon = coords[1].split(" ")[1];

  //   const url = `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&appid=${key}&units=imperial`;
  //   axios.get(url).then((res) => {
  //     console.log(res.data);

  //     let lonLat = globus.planet.getLonLatFromPixelTerrain(e);
  //     globus.planet.terrain.getHeightAsync(lonLat, (h) => {
  //       myPopup.setContent(
  //         `<div>Degrees Farenheit: ${res.data.main.temp}</div>`
  //       );
  //     });
  //     let groundPos = globus.planet.getCartesianFromMouseTerrain();
  //     myPopup.setCartesian3v(groundPos);
  //     myPopup.setVisibility(true);
  //   });
  // });




  
</script>

